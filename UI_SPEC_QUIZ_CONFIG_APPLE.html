<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CodeMaster - Configuration Quiz</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Configuration Tailwind pour le Design System Apple -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', 'sans-serif'],
                    },
                    boxShadow: {
                        'apple-card': '0 4px 12px rgba(0,0,0,0.05)',
                        'apple-hover': '0 8px 24px rgba(0,0,0,0.08)',
                    },
                    colors: {
                        slate: {
                            50: '#F8F8F8', // Apple Light Gray Background
                        }
                    },
                    animation: {
                        'slide-in': 'slideIn 0.3s ease-out forwards',
                        'fade-in': 'fadeIn 0.2s ease-out forwards',
                    },
                    keyframes: {
                        slideIn: {
                            '0%': { transform: 'translateX(20px)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>

    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <style>
        /* Glassmorphism Utilities */
        .glass-nav {
            background-color: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
        }
        
        .safe-pb {
            padding-bottom: env(safe-area-inset-bottom, 32px);
        }

        /* Hide Scrollbar */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        
        /* Smooth interactions */
        .tap-highlight-transparent {
            -webkit-tap-highlight-color: transparent;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 min-h-screen antialiased selection:bg-blue-100">

<div id="app" class="min-h-screen flex flex-col relative overflow-hidden">

    <!-- 1. Navigation Bar (Sticky + Glassmorphism) -->
    <nav class="sticky top-0 z-50 w-full border-b border-gray-200/50 glass-nav transition-all duration-300">
        <div class="px-6 py-4 flex items-center justify-between max-w-2xl mx-auto">
            <!-- Back Button -->
            <button @click="goBack" 
                    class="flex items-center text-blue-600 hover:text-blue-700 active:opacity-60 transition-colors tap-highlight-transparent">
                <i class="ph ph-caret-left text-xl mr-1"></i>
                <span class="text-[17px] font-medium hidden sm:inline">Retour</span>
            </button>
            
            <!-- Title -->
            <h1 class="text-[17px] font-semibold text-slate-900 absolute left-1/2 transform -translate-x-1/2">
                {{ step === 'difficulty' ? 'Difficulté' : 'Nombre de questions' }}
            </h1>
            
            <!-- Close Button -->
            <button @click="closeFlow" 
                    class="flex items-center text-slate-400 hover:text-slate-600 active:opacity-60 transition-colors bg-gray-100/50 rounded-full p-1">
                <i class="ph ph-x text-lg"></i>
            </button>
        </div>
    </nav>

    <!-- 2. Main Content Area -->
    <main class="flex-grow px-6 py-8 pb-safe max-w-2xl mx-auto w-full flex flex-col">
        
        <!-- STEP 1: DIFFICULTY SELECTION -->
        <transition name="fade" mode="out-in">
            <div v-if="step === 'difficulty'" key="difficulty" class="animate-slide-in w-full">
                
                <!-- Header -->
                <div class="text-center space-y-1 mb-8 animate-fade-in">
                    <h2 class="text-2xl font-bold text-slate-900 tracking-tight">Quel niveau ?</h2>
                    <p class="text-[15px] text-slate-500 font-medium">Choisis une difficulté pour commencer</p>
                </div>

                <!-- Cards Grid -->
                <div class="space-y-4">
                    <button v-for="diff in difficulties" 
                            :key="diff.id"
                            @click="selectDifficulty(diff)"
                            class="group w-full rounded-[24px] bg-white p-5 border border-gray-100/50 shadow-apple-card hover:shadow-apple-hover hover:bg-gray-50/50 active:scale-[0.98] transition-all duration-200 flex flex-col items-start gap-3 tap-highlight-transparent text-left relative overflow-hidden">
                        
                        <!-- Row 1: Icon + Title -->
                        <div class="flex items-center gap-3 w-full relative z-10">
                            <!-- Badge -->
                            <div class="w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0 transition-transform duration-300 group-hover:scale-110"
                                 :class="diff.colors.bg">
                                <i :class="['ph', diff.icon, 'text-2xl', diff.colors.text]"></i>
                            </div>

                            <!-- Text Info -->
                            <div class="flex flex-col">
                                <h3 class="text-[17px] font-semibold text-slate-900 capitalize leading-snug">
                                    {{ diff.label }}
                                </h3>
                                <span class="text-xs font-semibold text-slate-400 uppercase tracking-wide">
                                    {{ diff.points }} point{{ diff.points > 1 ? 's' : '' }}
                                </span>
                            </div>
                        </div>

                        <!-- Row 2: Description -->
                        <p class="text-[15px] text-slate-500 leading-relaxed font-medium pl-1">
                            {{ diff.description }}
                        </p>

                        <!-- Hover Highlight (Subtle) -->
                        <div class="absolute inset-0 bg-current opacity-0 group-hover:opacity-[0.02] pointer-events-none transition-opacity duration-300 text-blue-500"></div>
                    </button>
                </div>
            </div>

            <!-- STEP 2: COUNT SELECTION -->
            <div v-else-if="step === 'count'" key="count" class="animate-slide-in w-full">
                
                <!-- Header -->
                <div class="text-center space-y-1 mb-8 animate-fade-in">
                    <h2 class="text-2xl font-bold text-slate-900 tracking-tight">Combien de questions ?</h2>
                    <p class="text-[15px] text-slate-500 font-medium">Peux pas modifier après avoir commencé</p>
                </div>

                <!-- Cards Grid -->
                <div class="space-y-4">
                    <button v-for="opt in questionOptions" 
                            :key="opt.count"
                            @click="startQuiz(opt)"
                            :disabled="isLoading"
                            class="group w-full rounded-[24px] bg-white p-5 border border-gray-100/50 shadow-apple-card hover:shadow-apple-hover hover:bg-blue-50/30 active:scale-[0.98] transition-all duration-200 flex items-center justify-between gap-4 tap-highlight-transparent disabled:opacity-50 disabled:cursor-not-allowed">
                        
                        <!-- Left: Icon + Info -->
                        <div class="flex items-center gap-4 flex-1">
                            <!-- Badge -->
                            <div class="w-14 h-14 rounded-full flex items-center justify-center bg-blue-50/80 flex-shrink-0 group-hover:bg-blue-100 transition-colors duration-200">
                                <i :class="['ph', opt.icon, 'text-[28px] text-blue-600']"></i>
                            </div>

                            <!-- Text -->
                            <div class="text-left flex flex-col">
                                <h3 class="text-xl font-bold text-slate-900 leading-tight">
                                    {{ opt.count }} questions
                                </h3>
                                <span class="text-[15px] text-slate-500 font-medium">
                                    ~{{ opt.time }}
                                </span>
                            </div>
                        </div>

                        <!-- Right: Chevron -->
                        <i class="ph ph-caret-right text-slate-300 text-xl group-hover:text-blue-500 group-hover:translate-x-1 transition-all duration-200"></i>
                    </button>
                </div>
            </div>
            
            <!-- LOADING STATE OVERLAY -->
            <div v-else-if="step === 'loading'" key="loading" class="absolute inset-0 z-10 flex flex-col items-center justify-center bg-slate-50/90 backdrop-blur-sm">
                <div class="w-12 h-12 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mb-4"></div>
                <p class="text-slate-600 font-medium animate-pulse">Création du quiz...</p>
            </div>
        </transition>

    </main>

    <!-- Toast Notification (Pour la démo) -->
    <div v-if="toast" class="fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-slate-800/90 backdrop-blur-md text-white px-6 py-3 rounded-full shadow-lg z-50 animate-fade-in flex items-center gap-2">
        <i class="ph ph-check-circle text-green-400 text-xl"></i>
        <span class="font-medium text-sm">{{ toast }}</span>
    </div>

</div>

<script>
    const { createApp, ref, computed } = Vue;

    createApp({
        setup() {
            // State
            const step = ref('difficulty'); // 'difficulty', 'count', 'loading'
            const selectedDifficulty = ref(null);
            const isLoading = ref(false);
            const toast = ref(null);

            // Data: Difficulties
            const difficulties = [
                {
                    id: 'facile',
                    label: 'Facile',
                    points: 1,
                    icon: 'ph-smiley',
                    description: 'Parfait pour débuter. Consolidez les bases.',
                    colors: { bg: 'bg-green-100 text-green-700', text: 'text-green-700' }
                },
                {
                    id: 'moyen',
                    label: 'Moyen',
                    points: 2,
                    icon: 'ph-lightning',
                    description: 'Pour progresser. Teste tes connaissances.',
                    colors: { bg: 'bg-amber-100 text-amber-700', text: 'text-amber-700' }
                },
                {
                    id: 'difficile',
                    label: 'Difficile',
                    points: 3,
                    icon: 'ph-fire',
                    description: 'Ultime défi. Maîtrise complète requise.',
                    colors: { bg: 'bg-red-100 text-red-700', text: 'text-red-700' }
                },
                {
                    id: 'random',
                    label: 'Aléatoire',
                    points: '?',
                    icon: 'ph-shuffle',
                    description: 'Mélange tous les niveaux. Variété garantie.',
                    colors: { bg: 'bg-purple-100 text-purple-700', text: 'text-purple-700' }
                }
            ];

            // Data: Count Options
            const questionOptions = [
                { count: 5, time: '2-3 min', icon: 'ph-lightning' },
                { count: 10, time: '5-7 min', icon: 'ph-books' },
                { count: 20, time: '10-15 min', icon: 'ph-target' }
            ];

            // Actions
            const selectDifficulty = (diff) => {
                selectedDifficulty.value = diff;
                step.value = 'count';
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            const startQuiz = (option) => {
                isLoading.value = true;
                step.value = 'loading'; // Show loading state

                // Simulation d'un appel API/Store
                setTimeout(() => {
                    isLoading.value = false;
                    showToast(`Quiz lancé : ${selectedDifficulty.value.label} / ${option.count} questions`);
                    
                    // Reset pour la démo après 2 secondes
                    setTimeout(() => {
                        window.location.reload(); 
                        // Dans la vraie app: router.push('/quiz/active')
                    }, 2000);
                }, 1500);
            };

            const goBack = () => {
                if (step.value === 'count') {
                    step.value = 'difficulty';
                } else {
                    showToast("Retour vers Home");
                    // router.push('/home')
                }
            };

            const closeFlow = () => {
                showToast("Annulation du quiz");
                // router.push('/home')
            };

            const showToast = (msg) => {
                toast.value = msg;
                setTimeout(() => toast.value = null, 3000);
            };

            return {
                step,
                difficulties,
                questionOptions,
                selectDifficulty,
                startQuiz,
                goBack,
                closeFlow,
                isLoading,
                toast
            };
        }
    }).mount('#app');
</script>

</body>
</html>